<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="pt" lang="pt">
<head>
    <title>Manual SliTaz (pt) - Servidor de Internet LightTPD</title>    
    <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1" />
    <meta name="description" content="slitaz portuguese handbook" />
    <meta name="expires" content="never" />
    <meta name="modified" content="2008-07-18 07:00:00" />
    <meta name="publisher" content="www.slitaz.org" />
    <meta name="author" content="Christophe Lincoln" />
    <link rel="shortcut icon" href="favicon.ico" />
    <link rel="stylesheet" type="text/css" href="book.css" />
</head>
<body bgcolor="#ffffff">

<!-- Header and quick navigation -->
<div id="header">
<div id="quicknav" align="right">
    <a name="top"></a>
    <a href="chroot-env.html">Ambiente Chroot</a> |
    <a href="index.html">Conteúdo</a>
</div>
<h1><font color="#3e1220">Manual SliTaz (pt)</font></h1>
</div>

<!-- Content. -->
<div id="content">
<div class="content-right"></div>

<h2><font color="#df8f06">Servidor de Internet LightTPD</font></h2>

<ul>
	<li><a href="web-server.html#about">Sobre o LightTPD.</a></li>
	<li><a href="web-server.html#var-www">/var/www</a> - Diretório raiz de documentos.</li>
	<li><a href="web-server.html#Public">~/Public</a> - Diretório público de usuários.</li>
	<li><a href="web-server.html#config">lighttpd.conf</a> - Arquivo de Configuração do LightTPD.</li>
	<li><a href="web-server.html#start-stop-restart">Inicie, pare e reinicie o servidor.</a></li>
	<li><a href="web-server.html#cgi-perl">Scripts CGI e Perl</a> - Scripts CGI usando Perl.</li>
	<li><a href="web-server.html#cgi-python">Scripts CGI e Python</a> - Scripts CGI usando Python.</li>
	<li><a href="web-server.html#auth">Autenticação</a> - Proteção para diretórios.</li>
</ul>

<a name="about"></a>
<h3>Sobre o LightTPD</h3>
<p>
Este capítulo descreve a configuração e uso do servidor de internet LightTPD. 
É um servidor de HTTP rápido, seguro, flexível e que consome pouca memória RAM. 
Habilita uma administração inteligente dos recursos da cpu e oferece suporte a 
FastCGI, CGI, Auth, compressão de Output, reescritura de URLs, etc. O LightTPD é
um modo barato para hospedar seu próprio site em uma máquina antiga. 
</p>
<p>
No SliTaz o servidor é lançado automaticamente na inicialização do sistema e é 
pré-configurado com PHP. A raiz dos documentos por padrão está em 
<code>/var/www</code>, contendo a página padrão <code>index.html</code>.
Imagens são armazenadas no diretório <code>images/</code>. Website do LightTPD: 
<a href="http://www.lighttpd.net/">http://www.lighttpd.net/</a>   
</p>
<a name="var-www"></a>
<h3>/var/www - Diretório raiz de documentos</h3>
<p>
A pasta /var/www é o diretório <em>raiz</em> de documentos - você pode ter acesso 
a ela pela URL <a href="http://localhost/">http://localhost/</a>. Se você quiser 
hospedar um site, você pode salvar todos seus documentos aqui. Se você quiser 
hospedar múltiplos sites, você precisará criar os hosts virtuais. Note que você 
também pode conferir o <a href="http://localhost/server-status">http://localhost/server-status</a>.   
</p>
<a name="Public"></a>
<h3>~/Public - Diretório público de usuários </h3>
<p>
O SliTaz provê aos usuários do sistema um espaço público para colocar documentos,
geralmente HTML. Este diretório chama-se Public e deve estar dentro da raiz de seu 
espaço de usuário, como por exemplo /home/hacker/Public. Para criar este diretório 
use o comando mkdir:   
</p>
<pre> $ mkdir ~/Public
</pre>
<p>
Você pode ter acesso então pela URL: 
<a href="http://localhost/%7Ehacker/">http://localhost/~hacker/</a>. Você também 
pode usar o nome de máquina ou o endereço IP se conectar de outro computador. 
</p>
<a name="config"></a>
<h3>/etc/lighttpd/lighttpd.conf - arquivo de configuração do LightTPD</h3>
<p>
O arquivo de configuração principal do LightTPD (<code>lighttpd.conf</code>) é 
encontrado em /etc/lighttpd/. Este arquivo provido por SliTaz é auto-explicativo,
leia-o para maiores informações. Você pode achar outros exemplos no website do 
LightTPD. No SliTaz você achará também o arquivo <code>vhosts.conf</code> para a
configuração de qualquer host virtual (hospedar vários sites no mesmo servidor).   
</p>
<a name="start-stop-restart"></a>
<h3>Inicie, pare, reinicie o servidor de internet</h3>
<p>
Por padrão o SliTaz inicia o servidor automaticamente no boot, para prevenir isto 
você precisa remover o <code>lighttpd</code> da variável RUN_DAEMONS localizado 
no arquivo de sistema <code>/etc/rcS.conf</code>. Para iniciar, parar ou reiniciar 
o servidor você pode usar os comandos: 
<code>/etc/init.d/lighttpd [binstart|stop|restart]</code>. Exemplo para reiniciar
o servidor após mudar o arquivo de configuração: 
</p>
<pre> # /etc/init.d/lighttpd restart
</pre>
<a name="cgi-perl"></a>
<h3>Scripts CGI usando Perl </h3>
<p>
Para configurar o servidor de LightTPD para localizar o caminho do binário do 
<code>perl</code> e usar CGI/Perl, você precisará instalar o perl e modificar o 
arquivo de configuração de servidor. Exemplo usando o Geany: 
</p>
<pre> # tazpkg get-install perl
 # geany /etc/lighttpd/lighttpd.conf &amp;
</pre>
<pre class="script"># CGI module. Você pode instalar o Perl e atribuir scripts .pl e .cgi
# para o executável /usr/bin/perl
$HTTP["url"] =~ "/cgi-bin/" {
  cgi.assign = (
    ".sh" =&gt; "/bin/sh",
    ".cgi" =&gt; "/usr/bin/perl,
    ".pl" =&gt; "/usr/bin/perl
  )
}
</pre>
<a name="cgi-python"></a>
<h3>Scripts CGI que usam Python</h3>
<p>
Para configurar o servidor LightTPD para localizar o caminho do binário 
<code>python</code> e usar CGI/Python, você precisará instalar o python e 
modificar o arquivo de configuração do servidor. Exemplo usando o Geany:   
</p>
<pre> # tazpkg get-install python
 # geany /etc/lighttpd/lighttpd.conf &amp;
</pre>
<pre class="script"># CGI module. Você pode instalar o Python e atribuir scripts .py e .cgi
# para o executável /usr/bin/python
$HTTP["url"] =~ "/cgi-bin/" {
  cgi.assign = (
    ".sh" =&gt; "/bin/sh",
    ".cgi" =&gt; "/usr/bin/python,
    ".py" =&gt; "/usr/bin/python
  )
}
</pre>
<p>
Para as mudanças fazerem efeito e para usar os seus primeiros scripts de CGI no
SliTaz, apenas reinicie o servidor LightTPD:  
</p>
<pre> # /etc/init.d/lighttpd restart
</pre>
<a name="auth"></a>
<h3>Autenticação - Proteção para os diretórios</h3>
<p>
LightTPD provê módulos de autenticação que podem, por exemplo, proteger um 
diretório. O servidor oferece vários métodos de autenticação, mas nós começaremos
usando o método básico sem codificar qualquer password. Para poder usar o módulo 
<code>mod_auth</code> você tem que instalar o pacote lighttpd-modules 
(<code>tazpkg get-install lighttpd-modules</code>). Uma vez instalado, o 
<code>mod_auth</code> deve ser adicionado à lista de módulos:
</p>
<pre class="script"># Modules to load.
# See /usr/lib/lighttpd for all available modules.
#
server.modules = (
  "mod_access",
  "mod_auth",
  "...",
)
</pre>
<p>
Agora você pode configurar os módulos especificando o nível de depuração (debug) 
e método (<code>plain</code>) e o caminho para o arquivo que contém uma lista de 
nomes usando uma password protegida para ter acesso aos diretórios. Você também 
tem que definir os diretórios que requerem autorização. Neste exemplo nós 
protegeremos o diretório <code>/admin</code> e autorizaremos o acesso para o 
usuário hacker (<code>user=hacker</code>):   
</p>
<pre class="script"># Authentication for protected directory.
auth.debug = 2
auth.backend = "plain"
auth.backend.plain.userfile = "/etc/lighttpd/plain.passwd"
auth.require = ( "/admin/" =&gt;
(
"method" =&gt; "basic",
"realm" =&gt; "Password protected area",
"require" =&gt; "user=hacker"
)
)
</pre>
<p>
Finalmente, nós vamos criar agora o arquivo que contém as passwords, adicionar 
um usuário e reiniciar o servidor para testar. A sintaxe básica para o arquivo 
é <code>user:password</code>. Você pode criar o arquivo e pode adicionar um 
usuário com o comando <code>echo</code> ou pode editar com seu editor de texto 
favorito. Para acrescentar <code>hacker:root</code> ao arquivo de passwords 
<code>/etc/lighttpd/plain.passwd</code>:  
</p>
<pre> # echo "hacker:root" &gt; /etc/lighttpd/plain.passwd
 Ou :
 # nano /etc/lighttpd/plain.passwd
</pre>
<p>
Para testar o endereço: <strong>http://localhost/admin/</strong>, apenas reinicie
o servidor:
</p>
<pre> # /etc/init.d/lighttpd restart
</pre>

<!-- End of content -->
</div>

<!-- Footer. -->
<div id="footer">
	<div class="footer-right"></div>
	<a href="web-server.html#top">Topo da Página</a> | 
	<a href="index.html">Conteúdo</a>
</div>

<div id="copy">
    Copyright © 2008 <a href="http://www.slitaz.org/pt/">SliTaz</a> -
    <a href="http://www.gnu.org/licenses/gpl.html">GNU General Public License</a>;<br />
    Documentation is under
    <a href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License</a>
    and code is <a href="http://validator.w3.org/">valid xHTML 1.0</a>.
</div>

</body>
</html>

