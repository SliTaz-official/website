<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="pt" lang="pt">
<head>
    <title>Manual SliTaz (pt) - Configuração de rede</title>
    <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1" />
    <meta name="description" content="slitaz portuguese handbook network config pppoe ppp eth dhcp" />
    <meta name="expires" content="never" />
    <meta name="modified" content="2008-07-17 22:30:00" />
    <meta name="publisher" content="www.slitaz.org" />
    <meta name="author" content="Paul Issot, Christophe Lincoln"/>
    <link rel="shortcut icon" href="favicon.ico" />
    <link rel="stylesheet" type="text/css" href="book.css" />
</head>
<body bgcolor="#ffffff">

<!-- Header and quick navigation -->
<div id="header">
<div align="right" id="quicknav">
    <a name="top"></a>
    <a href="system-admin.html">Administração do sistema</a> |
    <a href="index.html">Conteúdo</a>
</div>
<h1><font color="#3E1220">Manual SliTaz (pt)</font></h1>
</div>

<!-- Content. -->
<div id="content">
<div class="content-right"></div>

<h2><font color="#DF8F06">Configuração de rede</font></h2>

<ul>
    <li><a href="#eth">Conexão Ethernet</a> - DHCP ou IP estático.</li>
    <li><a href="#driver">Instalação de driver de uma placa de rede</a> - 
     Encontre e carregue módulos do Kernel.</li>
    <li><a href="#netbox">Netbox</a> - Configurarão de rede.</li>
    <li><a href="#pppoe">PPPoE kernel-mode</a> - Conexão discada em modo-Kernel.</li>
    <li><a href="#rp-pppoe">PPPoE com o rp-pppoe</a> - Conexão ADSL.</li>
    <li><a href="#firewall">Firewall</a> - Gerenciamento do Firewall (Iptables).</li>
</ul>

<a name="eth"></a>
<h3>Conexão Ethernet</h3>
<p>
Por padrão o SliTaz executa, no momento do boot, um cliente DHCP (udhcpc) no 
eth0. Se a sua placa de rede for identificada como sendo de interface 
<code>eth0</code> e se você usar um roteador, sua conexão provavelmente estará
funcionando. O DHCP é configurado dinamicamente: a cada boot o cliente requisita
do servidor DHCP um novo endereço IP, o qual é integrado ao roteador ou a outro
computador. Se for necessária a utilização de um IP estático, pode-se editar 
diretamente os arquivos de configuração ou usar o aplicativo gráfico 
<code>netbox</code> disponível no menu JWM --&gt; System tools. Em um terminal
ou no console Linux você pode listar todas as interfaces de rede disponíveis
com o comando <code>ifconfig</code> seguido da opção <code>-a</code>:
</p>
<pre>
 $ ifconfig -a
</pre>
<p>
Para mostrar a tabela de roteamento de IP do Kernel, você pode usar o comando
<code>route</code> sem nenhum argumento:
</p>
<pre>
$ route
</pre>
<p>
O arquivo de configuração de rede principal é o <code>/etc/network.conf</code>.
Ele pode ser graficamente configurado com o <code>netbox</code> ou editado
diretamente pelo administrador root.
</p>

<a name="driver"></a>
<h3>Instale um driver de placa de rede</h3>
<p>
Caso haja a necessidade de um driver de placa de rede e você não sabe o seu nome,
pode-se utilizar o comando <code>lspci</code> para encontrar sua placa e então
o comando <code>modprobe</code> para carregar o módulo correspondente. No modo
Live você pode usar a opção de boot do SliTaz <code>modprobe=modules</code>
para carregar automaticamente módulos do Kernel. Para obter uma lista de todos
os drivers de placa de rede disponíveis, mostrar placas PCI eth e carregar
um módulo:
</p>
<pre>
 # modprobe -l | grep drivers/net
 # lspci | grep [Ee]th
 # modprobe -v module_name
</pre>
<p>
Em um sistema instalado você só precisa adicionar o nome do módulo à variável
<code>LOAD_MODULES </code> em <code>/etc/rcS.conf</code> para carregar seu módulo
a cada boot.
</p>

<a name="netbox"></a>
<h3>Netbox - Configure a rede</h3>
<p>
O Netbox é um pequeno aplicativo GTK+ para configurar a interface de rede usando
<em>DCHP</em> ou um endereço IP fixo (<em>static</em>). As abas podem ser usadas
para iniciar/parar a conexão e automaticamente mudar os valores dos arquivos de
sistema. O Netbox também oferece a aba <em>system wide</em> na qual você pode
editar diretamente os arquivos de configuração de rede. Este aplicativo pode ser
executado a partir do menu "system tools" ou pelo terminal:
</p>
<pre>
 # netbox 
</pre>

<a name="pppoe"></a>
<h3><font color="#6c0023">Conexão PPPoE em modo-kernel</font></h3>
<p>
Conexão PPPoE em modo-Kernel necessita de 2 arquivos. O primeiro arquivo é o 
<code>/etc/ppp/options</code> no qual você deve especificar seu login:
</p>
<pre class="script">
plugin rp-pppoe.so
name &lt;seu login fornecido pelo provedor de conexão&gt;
noipdefault
defaultroute
mtu 1492
mru 1492
lock
</pre>
<p>
Você também deve configurar o arquivo /etc/ppp/pap-secrets ou o 
/etc/ppp/chap-secrets:
</p>
<pre class="script">
# client           server           secret            IP addresses
"seu_login"        *                "sua_senha"
</pre>
<p>
O arquivo de configuração /etc/resolv.conf será automaticamente carregado.
Terminada a configuração, você pode conectar-se à internet com o comando 
<code>pppd</code>:
</p>
<pre>
pppd eth0
</pre>
<p>
Em um sistema instalado você pode iniciar o pppd a cada boot usando o script
de inicialização local: <code>/etc/init.d/local.sh</code>
</p>

<a name="rp-pppoe"></a>
<h3><font color="#6c0023">Habilite uma conexão ADSL-  PPPoE com rp-pppoe</font></h3>
<p>
Para configurar um protocolo ADSL via PPPoE, o SliTaz fornece o utilitário
<code>rp-pppoe</code>. Usar <code>pppoe-setup</code> permite uma rápida configuração
da rede. Se você usar DHCP é fica mais simples ainda, em decorrência de o servidor
de seu provedor de acesso encarregar-se de tudo. Se você não possuir DHCP,
deve primeiro desabilitar seu uso via a opção <code>DHCP="no"</code> do
arquivo de configuração <code>/etc/network.conf</code>. Deve-se notar que para
modificar os arquivos de configuração e os logs do sistema você deve primeiro
tornar-se <code>root</code>. Para instalar e mudar a variável DHCP com o Nano
(ctrl + x para salvar &amp; sair):
</p>
<pre>
 $ su
 # tazpkg get-install rp-pppoe
 # nano /etc/network.conf
</pre>
<h4>Configure com pppoe-setup</h4>
<p>
Para iniciar a configuração de sua conexão PPPoE, deve-se primeiro abrir o Xterm
ou o console Linux e executar <code>pppoe-setup</code> para então começar a
responder as seguintes questões:
</p>
<pre>
  # pppoe-setup
</pre>
<ol>
    <li>Informe seu nome de usuário. Por favor note que este é o nome de usuário
     que você utiliza para comunicar-se com seu provedor de acesso.</li>
    <li>Interface de internet: o padrão é eth0 ao menos que você possua mais
     de uma. Neste caso haverá eth1, eth2, etc. Geralmente teclar ENTER é 
     suficiente.</li>
    <li>Se você possuir um link ADSL permanente responda <strong>yes</strong>,
     do contrário responda <strong>no</strong> (resposta padrão).</li>
    <li>Especifique o DNS primário e secundário de seu provedor de acesso 
     (você precisa pedir essa informação).</li>
    <li>Entre com a senha com a qual você se comunica com seu provedor de acesso
     (será necessário informá-la duas vezes).</li>
    <li>Escolha as configurações de firewall dependendo de seu hardware. Se 
     você possuir um roteador você pode teclar 1 ou 2. Na dúvida tecle 1.</li>
</ol>
<h4>Inicie e pare a conexão</h4>
<p>
Ainda usando a linha de comando, simplesmente digite <code>pppoe-start</code> 
para iniciar a conexão. Após alguns segundos o sistema informará que você está
conectado. Se ele mostrar uma mensagem como TIMED OUT você deve ter configurado
incorretamente a conexão pode estar defeituosa. Por favor verifique a fiação
e repita a instalação desde o início. Para iniciar a conexão:
</p>
<pre> # pppoe-start
</pre>
<p>
Para parar a conexão, digite:
<code>pppoe-stop</code>.
</p>

<a name="firewall"></a>
<h3><font color="#6c0023">Gerencie o Firewall (<em>firewall</em>) 
     usando o Iptables</font></h3>
<p>
O SliTaz fornece um firewall básico em que as regras de segurança do Kernel
são executadas no momento do boot e as regras do Iptables estão desabilitadas
por padrão. Pode-se ativar/desativar isto no momento da inicialização usando-se
o arquivo de configuração /etc/firewall.conf.
</p>
<p>
O script de <em>firewall</em> padrão inicia-se com suas próprias diretivas para
o Kernel, isto é, redirecionamentos ICMP, roteamento fonte, logs para endereços
não resolvidos e filtros spoof. O script então executa as regras definidas na 
função <code>iptables_rules()</code> do arquivo de configuração /etc/firewall.conf.
</p>
<p>
O <em>firewall</em> usa o Iptables, que consiste em dois arquivos, o 
/etc/firewall.conf e o /etc/init.d/firewall - você não precisa modificá-los.
Note que o Iptables possui diversas opções, para maiores informações veja a
documentação oficial disponível online:
<a href="http://www.netfilter.org/documentation/">www.netfilter.org/documentation/</a>.
</p>
<h4>Inicie, pare e reinicie o firewall</h4>
<p>
O script /etc/init.d/firewall permite a você iniciar/reiniciar, para ou mostrar
o status do firewall. A opção de reinicio é geralmente usada para testar novas
regras adicionadas após a edição do arquivo de configuração. Exemplo:
</p>
<pre>
 # /etc/init.d/firewall restart
</pre>
<h4>Habilite/desabilite o firewall no momento do boot</h4>
<p>
Para habilitar/desabilitar opções específicas do Kernel defina "yes" ou "no" na
variável KERNEL_SECURITY= :
</p>
<pre class="script">
# Enable/disable kernel security at boot time.
KERNEL_SECURITY="yes"
</pre>
<p>
E para ativar/desativar as regras do iptables, é necessário modificar a variável
IPTABLES_RULES= :
</p>
<pre class="script">
# Enable/disable iptables rules.
IPTABLES_RULES="yes"
</pre>
<h4>Adicione, remova ou modifique regras do iptables</h4>
<p>
No topo do arquivo de configuração /etc/firewall.con você encontra uma função
chamada <code>iptables_rules()</code>. Esta função contem todos os comandos do
iptables executados quando o firewall é iniciado. Para remover uma regra, é
recomendável comentar a linha correspondente com <code>#</code>. <em>Não</em>
é recomendável deixar a função totalmente vazia: se você quiser desabilitar
as regras do iptables apenas adicione "no" à variável IPTABLES_RULES= no 
arquivo de configuração.
</p>
<p>
Abaixo um exemplo usando as regras do iptables. Aqui permitimos somente
conexões ao host local e à rede local, sendo que as portas 80, 22 e 21 são 
usadas pelo servidor web, pelo servidor SSH e pelo servidor FTP, respectivamente.
Todas as outras conexões de entrada e saída são recusadas - note que esta é uma
configuração bem restritiva.
</p>
<pre class="script">
# Netfilter/iptables rules.
# This shell function is included in /etc/init.d/firewall.sh
# to start iptables rules.
#
iptables_rules()
{

# Drop all connections.
iptables -P INPUT DROP
iptables -P OUTPUT DROP

# Accept all on localhost (127.0.0.1).
iptables -A INPUT -i lo -j ACCEPT
iptables -A OUTPUT -o lo -j ACCEPT

# Accept all on the local network (192.168.0.0/24).
iptables -A INPUT -s 192.168.0.0/24 -j ACCEPT
iptables -A OUTPUT -d 192.168.0.0/24 -j ACCEPT

# Accept port 80 for the HTTP server.
iptables -A INPUT -i $INTERFACE -p tcp --sport 80 -j ACCEPT
iptables -A OUTPUT -o $INTERFACE -p tcp --dport 80 -j ACCEPT

# Accept port 22 for SSH.
iptables -A INPUT -i $INTERFACE -p tcp --dport 22 -j ACCEPT
iptables -A OUTPUT -o $INTERFACE -tcp --sport 22 -j ACCEPT

# Accept port 21 for active FTP connections.
iptables -A INPUT -i $INTERFACE -p tcp --dport 21 -j ACCEPT
iptables -A OUTPUT -i $INTERFACE -p tcp --sport 21 -j ACCEPT

}

</pre>

<!-- End of content -->
</div>

<!-- Footer. -->
<div id="footer">
    <div class="footer-right"></div>
    <a href="#top">Topo da Página</a> | 
    <a href="index.html">Conteúdo</a>
</div>

<div id="copy">
    Copyright &copy; 2008 <a href="http://www.slitaz.org/pt/">SliTaz</a> -
    <a href="http://www.gnu.org/licenses/gpl.html">GNU General Public License</a>;<br />
    Documentation is under
    <a href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License</a>
    and code is <a href="http://validator.w3.org/">valid xHTML 1.0</a>.
</div>

</body>
</html>

